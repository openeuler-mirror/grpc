From 5b4344063e9d44cdd4e6f00729b48de2f2956145 Mon Sep 17 00:00:00 2001
From: Esun Kim <veblush@google.com>
Date: Tue, 29 Sep 2020 14:29:06 -0700
Subject: [PATCH] Upgrade Abseil to LTS 2020923.2

---
 bazel/grpc_deps.bzl                        |   8 +-
 gRPC-C++.podspec                           |   2 +-
 gRPC-Core.podspec                          |   2 +-
 src/abseil-cpp/preprocessed_builds.yaml    | 181 ++++++++++++++-------
 templates/gRPC-C++.podspec.template        |   2 +-
 templates/gRPC-Core.podspec.template       |   2 +-
 third_party/abseil-cpp                     |   2 +-
 tools/run_tests/sanity/check_submodules.sh |   2 +-
 8 files changed, 135 insertions(+), 66 deletions(-)

diff --git a/src/abseil-cpp/preprocessed_builds.yaml b/src/abseil-cpp/preprocessed_builds.yaml
index a6a35f2f6d45..257efad9b27f 100644
--- a/src/abseil-cpp/preprocessed_builds.yaml
+++ b/src/abseil-cpp/preprocessed_builds.yaml
@@ -93,12 +93,14 @@
   name: absl/base:core_headers
   src: []
 - cmake_target: absl::dynamic_annotations
-  deps: []
+  deps:
+  - absl/base:config
+  - absl/base:core_headers
   headers:
   - third_party/abseil-cpp/absl/base/dynamic_annotations.h
+  - third_party/abseil-cpp/absl/base/internal/dynamic_annotations.h
   name: absl/base:dynamic_annotations
-  src:
-  - third_party/abseil-cpp/absl/base/dynamic_annotations.cc
+  src: []
 - cmake_target: absl::endian
   deps:
   - absl/base:config
@@ -124,6 +126,13 @@
   name: absl/base:exponential_biased
   src:
   - third_party/abseil-cpp/absl/base/internal/exponential_biased.cc
+- cmake_target: absl::fast_type_id
+  deps:
+  - absl/base:config
+  headers:
+  - third_party/abseil-cpp/absl/base/internal/fast_type_id.h
+  name: absl/base:fast_type_id
+  src: []
 - cmake_target: absl::log_severity
   deps:
   - absl/base:config
@@ -187,6 +196,16 @@
   name: absl/base:spinlock_wait
   src:
   - third_party/abseil-cpp/absl/base/internal/spinlock_wait.cc
+- cmake_target: absl::strerror
+  deps:
+  - absl/base:config
+  - absl/base:core_headers
+  - absl/base:errno_saver
+  headers:
+  - third_party/abseil-cpp/absl/base/internal/strerror.h
+  name: absl/base:strerror
+  src:
+  - third_party/abseil-cpp/absl/base/internal/strerror.cc
 - cmake_target: absl::throw_delegate
   deps:
   - absl/base:config
@@ -206,6 +225,7 @@
   - absl/container:layout
   - absl/memory:memory
   - absl/meta:type_traits
+  - absl/strings:cord
   - absl/strings:strings
   - absl/types:compare
   - absl/utility:utility
@@ -233,7 +253,9 @@
   src: []
 - cmake_target: absl::container_memory
   deps:
+  - absl/base:config
   - absl/memory:memory
+  - absl/meta:type_traits
   - absl/utility:utility
   headers:
   - third_party/abseil-cpp/absl/container/internal/container_memory.h
@@ -242,6 +264,7 @@
 - cmake_target: absl::fixed_array
   deps:
   - absl/algorithm:algorithm
+  - absl/base:config
   - absl/base:core_headers
   - absl/base:dynamic_annotations
   - absl/base:throw_delegate
@@ -278,6 +301,7 @@
   deps:
   - absl/base:config
   - absl/hash:hash
+  - absl/strings:cord
   - absl/strings:strings
   headers:
   - third_party/abseil-cpp/absl/container/internal/hash_function_defaults.h
@@ -350,6 +374,7 @@
   src: []
 - cmake_target: absl::layout
   deps:
+  - absl/base:config
   - absl/base:core_headers
   - absl/meta:type_traits
   - absl/strings:strings
@@ -516,15 +541,38 @@
   - absl/base:raw_logging_internal
   - absl/debugging:debugging_internal
   - absl/debugging:demangle_internal
+  - absl/strings:strings
   headers:
   - third_party/abseil-cpp/absl/debugging/internal/symbolize.h
   - third_party/abseil-cpp/absl/debugging/symbolize.h
+  - third_party/abseil-cpp/absl/debugging/symbolize_darwin.inc
   - third_party/abseil-cpp/absl/debugging/symbolize_elf.inc
   - third_party/abseil-cpp/absl/debugging/symbolize_unimplemented.inc
   - third_party/abseil-cpp/absl/debugging/symbolize_win32.inc
   name: absl/debugging:symbolize
   src:
   - third_party/abseil-cpp/absl/debugging/symbolize.cc
+- cmake_target: absl::flags_commandlineflag
+  deps:
+  - absl/base:config
+  - absl/base:fast_type_id
+  - absl/flags:commandlineflag_internal
+  - absl/strings:strings
+  - absl/types:optional
+  headers:
+  - third_party/abseil-cpp/absl/flags/commandlineflag.h
+  name: absl/flags:commandlineflag
+  src:
+  - third_party/abseil-cpp/absl/flags/commandlineflag.cc
+- cmake_target: absl::flags_commandlineflag_internal
+  deps:
+  - absl/base:config
+  - absl/base:fast_type_id
+  headers:
+  - third_party/abseil-cpp/absl/flags/internal/commandlineflag.h
+  name: absl/flags:commandlineflag_internal
+  src:
+  - third_party/abseil-cpp/absl/flags/internal/commandlineflag.cc
 - cmake_target: absl::flags_config
   deps:
   - absl/base:config
@@ -546,9 +594,7 @@
   - absl/base:core_headers
   - absl/flags:config
   - absl/flags:flag_internal
-  - absl/flags:handle
-  - absl/flags:marshalling
-  - absl/flags:registry
+  - absl/flags:reflection
   - absl/strings:strings
   headers:
   - third_party/abseil-cpp/absl/flags/declare.h
@@ -561,29 +607,21 @@
   - absl/base:base
   - absl/base:config
   - absl/base:core_headers
+  - absl/flags:commandlineflag
+  - absl/flags:commandlineflag_internal
   - absl/flags:config
-  - absl/flags:handle
-  - absl/flags:registry
+  - absl/flags:marshalling
+  - absl/flags:reflection
   - absl/memory:memory
+  - absl/meta:type_traits
   - absl/strings:strings
   - absl/synchronization:synchronization
+  - absl/utility:utility
   headers:
   - third_party/abseil-cpp/absl/flags/internal/flag.h
   name: absl/flags:flag_internal
   src:
   - third_party/abseil-cpp/absl/flags/internal/flag.cc
-- cmake_target: absl::flags_handle
-  deps:
-  - absl/base:config
-  - absl/base:core_headers
-  - absl/flags:config
-  - absl/flags:marshalling
-  - absl/strings:strings
-  - absl/types:optional
-  headers:
-  - third_party/abseil-cpp/absl/flags/internal/commandlineflag.h
-  name: absl/flags:handle
-  src: []
 - cmake_target: absl::flags_marshalling
   deps:
   - absl/base:config
@@ -600,12 +638,14 @@
   deps:
   - absl/base:config
   - absl/base:core_headers
+  - absl/flags:commandlineflag
+  - absl/flags:commandlineflag_internal
   - absl/flags:config
   - absl/flags:flag
   - absl/flags:flag_internal
-  - absl/flags:handle
+  - absl/flags:private_handle_accessor
   - absl/flags:program_name
-  - absl/flags:registry
+  - absl/flags:reflection
   - absl/flags:usage
   - absl/flags:usage_internal
   - absl/strings:strings
@@ -624,6 +664,17 @@
   - third_party/abseil-cpp/absl/flags/internal/path_util.h
   name: absl/flags:path_util
   src: []
+- cmake_target: absl::flags_private_handle_accessor
+  deps:
+  - absl/base:config
+  - absl/flags:commandlineflag
+  - absl/flags:commandlineflag_internal
+  - absl/strings:strings
+  headers:
+  - third_party/abseil-cpp/absl/flags/internal/private_handle_accessor.h
+  name: absl/flags:private_handle_accessor
+  src:
+  - third_party/abseil-cpp/absl/flags/internal/private_handle_accessor.cc
 - cmake_target: absl::flags_program_name
   deps:
   - absl/base:config
@@ -636,22 +687,23 @@
   name: absl/flags:program_name
   src:
   - third_party/abseil-cpp/absl/flags/internal/program_name.cc
-- cmake_target: absl::flags_registry
+- cmake_target: absl::flags_reflection
   deps:
   - absl/base:config
   - absl/base:core_headers
-  - absl/base:raw_logging_internal
+  - absl/container:flat_hash_map
+  - absl/flags:commandlineflag
+  - absl/flags:commandlineflag_internal
   - absl/flags:config
-  - absl/flags:handle
+  - absl/flags:private_handle_accessor
   - absl/strings:strings
   - absl/synchronization:synchronization
   headers:
   - third_party/abseil-cpp/absl/flags/internal/registry.h
-  - third_party/abseil-cpp/absl/flags/internal/type_erased.h
-  name: absl/flags:registry
+  - third_party/abseil-cpp/absl/flags/reflection.h
+  name: absl/flags:reflection
   src:
-  - third_party/abseil-cpp/absl/flags/internal/registry.cc
-  - third_party/abseil-cpp/absl/flags/internal/type_erased.cc
+  - third_party/abseil-cpp/absl/flags/reflection.cc
 - cmake_target: absl::flags_usage
   deps:
   - absl/base:config
@@ -668,13 +720,14 @@
   deps:
   - absl/base:config
   - absl/base:core_headers
+  - absl/flags:commandlineflag
   - absl/flags:config
   - absl/flags:flag
   - absl/flags:flag_internal
-  - absl/flags:handle
   - absl/flags:path_util
+  - absl/flags:private_handle_accessor
   - absl/flags:program_name
-  - absl/flags:registry
+  - absl/flags:reflection
   - absl/strings:strings
   headers:
   - third_party/abseil-cpp/absl/flags/internal/usage.h
@@ -746,6 +799,7 @@
   src: []
 - cmake_target: absl::int128
   deps:
+  - absl/base:bits
   - absl/base:config
   - absl/base:core_headers
   headers:
@@ -758,25 +812,16 @@
 - cmake_target: absl::random_internal_distribution_caller
   deps:
   - absl/base:config
+  - absl/base:fast_type_id
+  - absl/utility:utility
   headers:
   - third_party/abseil-cpp/absl/random/internal/distribution_caller.h
   name: absl/random/internal:distribution_caller
   src: []
-- cmake_target: absl::random_internal_distributions
-  deps:
-  - absl/base:base
-  - absl/meta:type_traits
-  - absl/random/internal:distribution_caller
-  - absl/random/internal:traits
-  - absl/random/internal:uniform_helper
-  - absl/strings:strings
-  headers:
-  - third_party/abseil-cpp/absl/random/internal/distributions.h
-  name: absl/random/internal:distributions
-  src: []
 - cmake_target: absl::random_internal_fast_uniform_bits
   deps:
   - absl/base:config
+  - absl/meta:type_traits
   headers:
   - third_party/abseil-cpp/absl/random/internal/fast_uniform_bits.h
   name: absl/random/internal:fast_uniform_bits
@@ -806,16 +851,17 @@
   - third_party/abseil-cpp/absl/random/internal/iostream_state_saver.h
   name: absl/random/internal:iostream_state_saver
   src: []
-- cmake_target: absl::random_internal_mocking_bit_gen_base
+- cmake_target: absl::random_internal_mock_helpers
   deps:
-  - absl/random:random
-  - absl/strings:strings
+  - absl/base:fast_type_id
+  - absl/types:optional
   headers:
-  - third_party/abseil-cpp/absl/random/internal/mocking_bit_gen_base.h
-  name: absl/random/internal:mocking_bit_gen_base
+  - third_party/abseil-cpp/absl/random/internal/mock_helpers.h
+  name: absl/random/internal:mock_helpers
   src: []
 - cmake_target: ''
   deps:
+  - absl/base:config
   - absl/base:core_headers
   - absl/base:raw_logging_internal
   - absl/random/internal:platform
@@ -832,7 +878,6 @@
   - absl/random/internal:pool_urbg
   - absl/random/internal:salted_seed_seq
   - absl/random/internal:seed_material
-  - absl/strings:strings
   - absl/types:optional
   - absl/types:span
   headers:
@@ -855,10 +900,10 @@
   - absl/base:config
   headers:
   - third_party/abseil-cpp/absl/random/internal/platform.h
-  - third_party/abseil-cpp/absl/random/internal/randen-keys.inc
   - third_party/abseil-cpp/absl/random/internal/randen_traits.h
   name: absl/random/internal:platform
-  src: []
+  src:
+  - third_party/abseil-cpp/absl/random/internal/randen_round_keys.cc
 - cmake_target: absl::random_internal_pool_urbg
   deps:
   - absl/base:base
@@ -960,7 +1005,9 @@
   src: []
 - cmake_target: absl::random_internal_uniform_helper
   deps:
+  - absl/base:config
   - absl/meta:type_traits
+  - absl/random/internal:traits
   headers:
   - third_party/abseil-cpp/absl/random/internal/uniform_helper.h
   name: absl/random/internal:uniform_helper
@@ -978,10 +1025,11 @@
 - cmake_target: absl::random_bit_gen_ref
   deps:
   - absl/base:core_headers
+  - absl/base:fast_type_id
   - absl/meta:type_traits
   - absl/random/internal:distribution_caller
   - absl/random/internal:fast_uniform_bits
-  - absl/random/internal:mocking_bit_gen_base
+  - absl/random:random
   headers:
   - third_party/abseil-cpp/absl/random/bit_gen_ref.h
   name: absl/random:bit_gen_ref
@@ -992,7 +1040,7 @@
   - absl/base:config
   - absl/base:core_headers
   - absl/meta:type_traits
-  - absl/random/internal:distributions
+  - absl/random/internal:distribution_caller
   - absl/random/internal:fast_uniform_bits
   - absl/random/internal:fastmath
   - absl/random/internal:generate_real
@@ -1001,12 +1049,10 @@
   - absl/random/internal:uniform_helper
   - absl/random/internal:wide_multiply
   - absl/strings:strings
-  - absl/types:span
   headers:
   - third_party/abseil-cpp/absl/random/bernoulli_distribution.h
   - third_party/abseil-cpp/absl/random/beta_distribution.h
   - third_party/abseil-cpp/absl/random/discrete_distribution.h
-  - third_party/abseil-cpp/absl/random/distribution_format_traits.h
   - third_party/abseil-cpp/absl/random/distributions.h
   - third_party/abseil-cpp/absl/random/exponential_distribution.h
   - third_party/abseil-cpp/absl/random/gaussian_distribution.h
@@ -1055,6 +1101,7 @@
   - third_party/abseil-cpp/absl/random/seed_sequences.cc
 - cmake_target: absl::status
   deps:
+  - absl/base:atomic_hook
   - absl/base:config
   - absl/base:core_headers
   - absl/base:raw_logging_internal
@@ -1066,16 +1113,31 @@
   - absl/strings:strings
   - absl/types:optional
   headers:
+  - third_party/abseil-cpp/absl/status/internal/status_internal.h
   - third_party/abseil-cpp/absl/status/status.h
   - third_party/abseil-cpp/absl/status/status_payload_printer.h
   name: absl/status:status
   src:
   - third_party/abseil-cpp/absl/status/status.cc
   - third_party/abseil-cpp/absl/status/status_payload_printer.cc
+- cmake_target: absl::statusor
+  deps:
+  - absl/base:core_headers
+  - absl/base:raw_logging_internal
+  - absl/meta:type_traits
+  - absl/status:status
+  - absl/strings:strings
+  - absl/types:variant
+  - absl/utility:utility
+  headers:
+  - third_party/abseil-cpp/absl/status/internal/statusor_internal.h
+  - third_party/abseil-cpp/absl/status/statusor.h
+  name: absl/status:statusor
+  src:
+  - third_party/abseil-cpp/absl/status/statusor.cc
 - cmake_target: absl::cord
   deps:
   - absl/base:base
-  - absl/base:base_internal
   - absl/base:core_headers
   - absl/base:endian
   - absl/base:raw_logging_internal
@@ -1087,6 +1149,7 @@
   - absl/strings:internal
   - absl/strings:str_format
   - absl/strings:strings
+  - absl/types:optional
   headers:
   - third_party/abseil-cpp/absl/strings/cord.h
   name: absl/strings:cord
@@ -1094,6 +1157,8 @@
   - third_party/abseil-cpp/absl/strings/cord.cc
 - cmake_target: absl::cord
   deps:
+  - absl/base:base_internal
+  - absl/container:compressed_tuple
   - absl/meta:type_traits
   - absl/strings:strings
   headers:
@@ -1127,11 +1192,14 @@
   src: []
 - cmake_target: absl::str_format_internal
   deps:
+  - absl/base:bits
   - absl/base:config
   - absl/base:core_headers
+  - absl/functional:function_ref
   - absl/meta:type_traits
   - absl/numeric:int128
   - absl/strings:strings
+  - absl/types:optional
   - absl/types:span
   headers:
   - third_party/abseil-cpp/absl/strings/internal/str_format/arg.h
@@ -1311,6 +1379,7 @@
   deps:
   - absl/base:config
   - absl/base:core_headers
+  - absl/base:fast_type_id
   - absl/meta:type_traits
   - absl/types:bad_any_cast
   - absl/utility:utility
